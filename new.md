УНИВЕРСАЛЬНЫЙ АРХИТЕКТУРНЫЙ ПРОМПТ ДЛЯ CURSOR

(без жёсткой структуры блоков)

Скопируй и используй как стартовый промпт.

Ты — senior WordPress theme developer.
Нужно спроектировать и реализовать систему шаблонных страниц услуг в кастомной теме WordPress без использования плагинов для полей и конструкторов.

Общая задача

Сайт клиники.
Есть 20–30 услуг (All-on-4, All-on-6, Протезирование и т.д.).
Каждая услуга — отдельная страница с контентом, управляемым через админку.

Все услуги должны:

использовать единый шаблон страницы
состоять из наборов секций (блоков)
управляться контент-менеджером без правок кода

Ограничения

❌ нельзя использовать ACF, Carbon Fields, Elementor, Gutenberg как конструктор
❌ нельзя использовать плагины для мета-полей
✅ можно использовать Contact Form 7
✅ можно использовать WP Media Library

Реализация строго через:

кастомную тему
register_post_type (предпочтительно)
add_meta_box, save_post
get_post_meta
Код должен быть чистым, расширяемым и поддерживаемым

Архитектурный принцип (ключевой)

Один шаблон услуги
Множество секций (блоков)
Каждая секция опциональна

Секция:

имеет toggle “включено / выключено”
отображается только при наличии данных

Возможны:

общие секции (используются у многих услуг)
уникальные секции (используются у отдельных услуг)
Добавление новой секции не должно требовать переписывания шаблона страницы.

Требования к шаблону страницы

Единый файл шаблона (например, single-service.php)

Шаблон:

не содержит жёсткого HTML конкретных блоков
подключает секции через template-parts
использует условный рендеринг секций

Порядок секций:

по умолчанию фиксированный
при необходимости может быть переопределён через данные услуги (опционально)

Требования к секциям (блокам)

Каждая секция:

находится в template-parts/blocks/
получает данные через get_post_meta
не содержит бизнес-логики
не решает, когда отображаться (решение принимается на уровне шаблона)

может быть:

повторяемой
уникальной
расширяемой в будущем

Структура и наполнение секций не фиксируются сейчас — они будут обсуждаться и добавляться поэтапно.

Админка (очень важно)

Контент-менеджер:

работает только через админку
не редактирует PHP/HTML
заполняет поля, сгруппированные по секциям

Требования:

мета-поля логически сгруппированы
каждая секция имеет свой набор полей
есть визуальное разделение секций в админке
повторяемые элементы (списки, карточки и т.п.) реализованы без плагинов
загрузка изображений/иконок через стандартную медиатеку WordPress

Хранение данных

Все данные секций хранятся как post meta
Повторяемые структуры могут храниться в виде массивов

Все данные должны:

корректно сохраняться
валидироваться
экранироваться при выводе

Реализация должна учитывать:

autosave
permissions
nonces

Расширяемость (ключевое требование)

Архитектура должна позволять:

добавлять новые секции без ломки существующих
включать/выключать секции для конкретной услуги
постепенно усложнять структуру секций
использовать одни и те же секции на разных услугах

Ожидаемый результат

В админке создаётся услуга
Заполняются поля нужных секций
На фронтенде автоматически собирается страница услуги
Пустые или выключенные секции не отображаются
Контент-менеджер не может «сломать» страницу

Порядок работы

Предложи архитектуру решения
Опиши структуру файлов темы
Опиши общий механизм секций и мета-данных
Предложи базовые helper-функции
Только после подтверждения — переходи к реализации кода